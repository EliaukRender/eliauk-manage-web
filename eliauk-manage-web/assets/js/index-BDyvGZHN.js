import{an as N,aQ as W,by as Q,e as H,K as pe,f as Y,$ as J,aT as Ee,u as de,bO as me,n as Z,z as g,bP as Te,k as ye,bQ as be,l as Se,bo as V,E as le,b as U,_ as we,d as fe,p as Le,a as M,N as _e,r as G,O as ee,B as Ce,g as he,h as te,a5 as Oe,A as Ne}from"./index-CPnw0WSf.js";import{t as Ae}from"./event-CelxogyL.js";function qe(e){return e===void 0}let F;const Re=e=>{var n;if(!N)return 0;if(F!==void 0)return F;const t=document.createElement("div");t.className=`${e}-scrollbar__wrap`,t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const o=t.offsetWidth;t.style.overflow="scroll";const u=document.createElement("div");u.style.width="100%",t.appendChild(u);const r=u.offsetWidth;return(n=t.parentNode)==null||n.removeChild(t),F=o-r,F};function Qe(e,n){if(!N)return;if(!n){e.scrollTop=0;return}const t=[];let o=n.offsetParent;for(;o!==null&&e!==o&&e.contains(o);)t.push(o),o=o.offsetParent;const u=n.offsetTop+t.reduce((p,E)=>p+E.offsetTop,0),r=u+n.offsetHeight,c=e.scrollTop,i=c+e.clientHeight;u<c?e.scrollTop=u:r>i&&(e.scrollTop=r-e.clientHeight)}var x=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(x||{});const $=e=>{const n=W(e)?e:[e],t=[];return n.forEach(o=>{var u;W(o)?t.push(...$(o)):Q(o)&&W(o.children)?t.push(...$(o.children)):(t.push(o),Q(o)&&((u=o.component)!=null&&u.subTree)&&t.push(...$(o.component.subTree)))}),t},Je=(e,n,t,o)=>{let u={offsetX:0,offsetY:0};const r=p=>{const E=p.clientX,y=p.clientY,{offsetX:b,offsetY:S}=u,T=e.value.getBoundingClientRect(),s=T.left,a=T.top,d=T.width,l=T.height,f=document.documentElement.clientWidth,A=document.documentElement.clientHeight,R=-s+b,k=-a+S,K=f-s-d+b,w=A-a-l+S,L=C=>{let O=b+C.clientX-E,v=S+C.clientY-y;o!=null&&o.value||(O=Math.min(Math.max(O,R),K),v=Math.min(Math.max(v,k),w)),u={offsetX:O,offsetY:v},e.value&&(e.value.style.transform=`translate(${J(O)}, ${J(v)})`)},_=()=>{document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",_)};document.addEventListener("mousemove",L),document.addEventListener("mouseup",_)},c=()=>{n.value&&e.value&&n.value.addEventListener("mousedown",r)},i=()=>{n.value&&e.value&&n.value.removeEventListener("mousedown",r)};H(()=>{pe(()=>{t.value?c():i()})}),Y(()=>{i()})},Ze=(e,n={})=>{Ee(e)||Ae("[useLockscreen]","You need to pass a ref param to this function");const t=n.ns||de("popup"),o=me(()=>t.bm("parent","hidden"));if(!N||Z(document.body,o.value))return;let u=0,r=!1,c="0";const i=()=>{setTimeout(()=>{Se(document==null?void 0:document.body,o.value),r&&document&&(document.body.style.width=c)},200)};g(e,p=>{if(!p){i();return}r=!Z(document.body,o.value),r&&(c=document.body.style.width),u=Re(t.namespace.value);const E=document.documentElement.clientHeight<document.body.scrollHeight,y=Te(document.body,"overflowY");u>0&&(E||y==="scroll")&&r&&(document.body.style.width=`calc(100% - ${u}px)`),ye(document.body,o.value)}),be(()=>i())},ke=e=>{if(!e)return{onClick:V,onMousedown:V,onMouseup:V};let n=!1,t=!1;return{onClick:c=>{n&&t&&e(c),n=t=!1},onMousedown:c=>{n=c.target===c.currentTarget},onMouseup:c=>{t=c.target===c.currentTarget}}};let h=[];const ne=e=>{const n=e;n.key===le.esc&&h.forEach(t=>t(n))},Me=e=>{H(()=>{h.length===0&&document.addEventListener("keydown",ne),N&&h.push(e)}),Y(()=>{h=h.filter(n=>n!==e),h.length===0&&N&&document.removeEventListener("keydown",ne)})},X="focus-trap.focus-after-trapped",z="focus-trap.focus-after-released",Fe="focus-trap.focusout-prevented",oe={cancelable:!0,bubbles:!1},Ie={cancelable:!0,bubbles:!1},se="focusAfterTrapped",ue="focusAfterReleased",De=Symbol("elFocusTrap"),j=U(),B=U(0),q=U(0);let I=0;const ve=e=>{const n=[],t=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const u=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||u?NodeFilter.FILTER_SKIP:o.tabIndex>=0||o===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)n.push(t.currentNode);return n},re=(e,n)=>{for(const t of e)if(!Pe(t,n))return t},Pe=(e,n)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(n&&e===n)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},ge=e=>{const n=ve(e),t=re(n,e),o=re(n.reverse(),e);return[t,o]},xe=e=>e instanceof HTMLInputElement&&"select"in e,m=(e,n)=>{if(e&&e.focus){const t=document.activeElement;e.focus({preventScroll:!0}),q.value=window.performance.now(),e!==t&&xe(e)&&n&&e.select()}};function ce(e,n){const t=[...e],o=e.indexOf(n);return o!==-1&&t.splice(o,1),t}const He=()=>{let e=[];return{push:o=>{const u=e[0];u&&o!==u&&u.pause(),e=ce(e,o),e.unshift(o)},remove:o=>{var u,r;e=ce(e,o),(r=(u=e[0])==null?void 0:u.resume)==null||r.call(u)}}},Ye=(e,n=!1)=>{const t=document.activeElement;for(const o of e)if(m(o,n),document.activeElement!==t)return},ae=He(),Ue=()=>B.value>q.value,D=()=>{j.value="pointer",B.value=window.performance.now()},ie=()=>{j.value="keyboard",B.value=window.performance.now()},Be=()=>(H(()=>{I===0&&(document.addEventListener("mousedown",D),document.addEventListener("touchstart",D),document.addEventListener("keydown",ie)),I++}),Y(()=>{I--,I<=0&&(document.removeEventListener("mousedown",D),document.removeEventListener("touchstart",D),document.removeEventListener("keydown",ie))}),{focusReason:j,lastUserFocusTimestamp:B,lastAutomatedFocusTimestamp:q}),P=e=>new CustomEvent(Fe,{...Ie,detail:e}),Ke=fe({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[se,ue,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:n}){const t=U();let o,u;const{focusReason:r}=Be();Me(s=>{e.trapped&&!c.paused&&n("release-requested",s)});const c={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},i=s=>{if(!e.loop&&!e.trapped||c.paused)return;const{key:a,altKey:d,ctrlKey:l,metaKey:f,currentTarget:A,shiftKey:R}=s,{loop:k}=e,K=a===le.tab&&!d&&!l&&!f,w=document.activeElement;if(K&&w){const L=A,[_,C]=ge(L);if(_&&C){if(!R&&w===C){const v=P({focusReason:r.value});n("focusout-prevented",v),v.defaultPrevented||(s.preventDefault(),k&&m(_,!0))}else if(R&&[_,L].includes(w)){const v=P({focusReason:r.value});n("focusout-prevented",v),v.defaultPrevented||(s.preventDefault(),k&&m(C,!0))}}else if(w===L){const v=P({focusReason:r.value});n("focusout-prevented",v),v.defaultPrevented||s.preventDefault()}}};Le(De,{focusTrapRef:t,onKeydown:i}),g(()=>e.focusTrapEl,s=>{s&&(t.value=s)},{immediate:!0}),g([t],([s],[a])=>{s&&(s.addEventListener("keydown",i),s.addEventListener("focusin",y),s.addEventListener("focusout",b)),a&&(a.removeEventListener("keydown",i),a.removeEventListener("focusin",y),a.removeEventListener("focusout",b))});const p=s=>{n(se,s)},E=s=>n(ue,s),y=s=>{const a=M(t);if(!a)return;const d=s.target,l=s.relatedTarget,f=d&&a.contains(d);e.trapped||l&&a.contains(l)||(o=l),f&&n("focusin",s),!c.paused&&e.trapped&&(f?u=d:m(u,!0))},b=s=>{const a=M(t);if(!(c.paused||!a))if(e.trapped){const d=s.relatedTarget;!_e(d)&&!a.contains(d)&&setTimeout(()=>{if(!c.paused&&e.trapped){const l=P({focusReason:r.value});n("focusout-prevented",l),l.defaultPrevented||m(u,!0)}},0)}else{const d=s.target;d&&a.contains(d)||n("focusout",s)}};async function S(){await ee();const s=M(t);if(s){ae.push(c);const a=s.contains(document.activeElement)?o:document.activeElement;if(o=a,!s.contains(a)){const l=new Event(X,oe);s.addEventListener(X,p),s.dispatchEvent(l),l.defaultPrevented||ee(()=>{let f=e.focusStartEl;Ce(f)||(m(f),document.activeElement!==f&&(f="first")),f==="first"&&Ye(ve(s),!0),(document.activeElement===a||f==="container")&&m(s)})}}}function T(){const s=M(t);if(s){s.removeEventListener(X,p);const a=new CustomEvent(z,{...oe,detail:{focusReason:r.value}});s.addEventListener(z,E),s.dispatchEvent(a),!a.defaultPrevented&&(r.value=="keyboard"||!Ue()||s.contains(document.activeElement))&&m(o??document.body),s.removeEventListener(z,E),ae.remove(c)}}return H(()=>{e.trapped&&S(),g(()=>e.trapped,s=>{s?S():T()})}),Y(()=>{e.trapped&&T()}),{onKeydown:i}}});function We(e,n,t,o,u,r){return G(e.$slots,"default",{handleKeydown:e.onKeydown})}var et=we(Ke,[["render",We],["__file","focus-trap.vue"]]);const Ve=he({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:te([String,Array,Object])},zIndex:{type:te([String,Number])}}),$e={click:e=>e instanceof MouseEvent},Xe="overlay";var ze=fe({name:"ElOverlay",props:Ve,emits:$e,setup(e,{slots:n,emit:t}){const o=de(Xe),u=p=>{t("click",p)},{onClick:r,onMousedown:c,onMouseup:i}=ke(e.customMaskEvent?void 0:u);return()=>e.mask?Oe("div",{class:[o.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:r,onMousedown:c,onMouseup:i},[G(n,"default")],x.STYLE|x.CLASS|x.PROPS,["onClick","onMouseup","onMousedown"]):Ne("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[G(n,"default")])}});const tt=ze;export{tt as E,De as F,Ze as a,et as b,ke as c,$ as f,qe as i,Qe as s,Je as u};
